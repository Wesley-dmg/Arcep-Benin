<script src="/static/assets/vendor/js-cookie/js.cookie.js"></script>
<script src="/static/assets/vendor/jquery/dist/jquery.min.js"></script>
<script src="/static/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
<script src="/static/assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>
<script src="/static/assets/js/argon.js?v=1.2.0"></script>
<script src="/static/assets/js/argon.js?v=1.2.0"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    setTimeout(function () {
      var alertMessages = document.querySelectorAll('.alert-messages .alert')
      alertMessages.forEach(function (alert) {
        alert.style.display = 'none'
      })
    }, 1300) 
  })  
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const searchInput = document.getElementById('navbar-search-input');
        const searchResults = document.getElementById('navbar-search-results');

        // Fonction de recherche
        searchInput.addEventListener('input', function () {
            const query = searchInput.value.trim();

            if (query.length > 0) {
                fetch(`/ajax/recherche/?q=${query}`)
                    .then(response => response.json())
                    .then(data => {
                        // Réinitialise les résultats
                        searchResults.innerHTML = '';
                        searchResults.style.display = 'block';

                        if (data.resultats.length > 0) {
                            data.resultats.forEach(result => {
                                const li = document.createElement('li');
                                li.className = 'list-group-item list-group-item-action';
                                li.textContent = result.nom;
                                li.dataset.siteId = result.id;

                                // Clique sur un résultat
                                li.addEventListener('click', function () {
                                    window.location.href = `/site/${result.id}/`;
                                });

                                searchResults.appendChild(li);
                            });
                        } else {
                            const li = document.createElement('li');
                            li.className = 'list-group-item text-muted';
                            li.textContent = 'Aucun résultat trouvé.';
                            searchResults.appendChild(li);
                        }
                    })
                    .catch(error => {
                        console.error('Erreur lors de la recherche :', error);
                    });
            } else {
                searchResults.style.display = 'none';
            }
        });

        // Cacher les résultats si on clique en dehors
        document.addEventListener('click', function (e) {
            if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.style.display = 'none';
            }
        });
    });
</script>
